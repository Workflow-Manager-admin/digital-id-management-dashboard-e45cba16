{"is_source_file": true, "format": "Python", "description": "Main source file for a FastAPI-based backend for a Digital ID Management Dashboard. Defines API endpoints for authentication, admin/user management, digital ID holders, unique number linkage/unlinkage, and history tracking. Also includes ORM models, authentication utilities, and configuration for database and JWT handling.", "external_files": ["dotenv (optional, for environment variable loading)", "fastapi", "fastapi.security", "jose", "passlib", "pydantic", "sqlalchemy", "uvicorn"], "external_methods": ["load_dotenv", "FastAPI", "Depends", "HTTPException", "status", "Query", "OAuth2PasswordBearer", "OAuth2PasswordRequestForm", "CORSMiddleware", "jwt.encode", "jwt.decode", "CryptContext", "BaseModel", "EmailStr", "Field", "create_engine", "sessionmaker", "scoped_session", "declarative_base", "session", "os.getenv", "os.path.join", "datetime.utcnow", "datetime", "timedelta", "uvicorn.run"], "published": ["app", "health_check", "login_for_access_token", "invite_admin", "register_from_invite", "get_my_profile", "list_admins", "create_holder", "list_holders", "get_holder", "update_holder", "delete_holder", "create_unique_number", "list_unique_numbers", "link_number", "unlink_number", "get_history"], "classes": [{"name": "User", "description": "ORM model representing user accounts with roles (admin, superadmin), authentication and invitation tracking."}, {"name": "Invitation", "description": "ORM model representing invitations sent to potential admin users, including status and relation to User."}, {"name": "DigitalIDHolder", "description": "ORM model for entities holding digital IDs, with contact info and relationships to unique numbers and linkage history."}, {"name": "UniqueNumber", "description": "ORM model for unique identifiers which can be linked to digital ID holders."}, {"name": "LinkageHistory", "description": "ORM model for tracking linkage/unlinkage actions performed by admins on digital ID holders and numbers."}], "methods": [{"name": "verify_password", "description": "Verifies a plain password against its hashed version."}, {"name": "get_password_hash(password)", "description": "Hashes a password using bcrypt.", "scope": "", "scopeKind": ""}, {"name": "create_access_token(data: dict, expires_delta: timedelta = None)", "description": "Creates a JWT access token with expiration.", "scope": "", "scopeKind": ""}, {"name": "dict decode_access_token(token: str)", "description": "Decodes a JWT token and returns payload data.", "scope": "", "scopeKind": ""}, {"name": "get_db()", "description": "Provides a database session for FastAPI dependencies.", "scope": "", "scopeKind": ""}, {"name": "get_current_user(db: Session = Depends(get_db), token: str = Depends(oauth2_scheme))", "description": "Retrieves current user based on JWT token, or raises exception.", "scope": "", "scopeKind": ""}, {"name": "get_current_active_user(current_user: User = Depends(get_current_user))", "description": "Ensures current user is active.", "scope": "", "scopeKind": ""}, {"name": "get_current_admin(current_user: User = Depends(get_current_user))", "description": "Ensures current user has admin or superadmin role.", "scope": "", "scopeKind": ""}, {"name": "get_current_superadmin(current_user: User = Depends(get_current_user))", "description": "Ensures current user is a superadmin.", "scope": "", "scopeKind": ""}, {"name": "create_holder( data: DigitalIDHolderCreate, db: Session = Depends(get_db), current_user: User = Depends(get_current_admin) )", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "create_unique_number( data: UniqueNumberCreate, db: Session = Depends(get_db), current_user: User = Depends(get_current_admin) )", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "delete_holder(holder_id: int, db: Session = Depends(get_db), current_user: User = Depends(get_current_admin))", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "get_history( db: Session = Depends(get_db), holder_id: int = Query(None), number_id: int = Query(None), admin_id: int = Query(None), skip: int = Query(0), limit: int = Query(100), current_user: User = Depends(get_current_admin) )", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "get_holder(holder_id: int, db: Session = Depends(get_db), current_user: User = Depends(get_current_admin))", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "get_my_profile(current_user: User = Depends(get_current_active_user))", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "health_check()", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "init_db()", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "invite_admin( payload: InvitationCreate, db: Session = Depends(get_db), current_user: User = Depends(get_current_superadmin), )", "scope": "", "scopeKind": "", "description": "unavailable"}], "calls": ["load_dotenv", "jwt.encode", "jwt.decode", "uvicorn.run", "db.query", "db.add", "db.commit", "db.refresh"], "search-terms": ["FastAPI dashboard", "digital ID backend", "JWT authentication", "admin invitation", "unique number linkage", "link/unlink history", "user roles with SQLAlchemy"], "state": 2, "file_id": 6, "knowledge_revision": 51, "git_revision": "4e98b5ae5f87d9faa5e12a51615655189a67d8ef", "revision_history": [{"19": "c675b1c39062b9c05caa129692bbedacd55761c8"}, {"20": "8d86ad8102eb64257618a2adbd11c94c74d4d486"}, {"21": "8d86ad8102eb64257618a2adbd11c94c74d4d486"}, {"22": "8d86ad8102eb64257618a2adbd11c94c74d4d486"}, {"29": "d75b472b2edbb3718ac7d7f9b2b4bb1b499b601b"}, {"32": "d75b472b2edbb3718ac7d7f9b2b4bb1b499b601b"}, {"33": "d75b472b2edbb3718ac7d7f9b2b4bb1b499b601b"}, {"42": "f48c21f25c4c42532f112bb760b213b90638b5d9"}, {"43": "f48c21f25c4c42532f112bb760b213b90638b5d9"}, {"50": "f48c21f25c4c42532f112bb760b213b90638b5d9"}, {"51": "4e98b5ae5f87d9faa5e12a51615655189a67d8ef"}], "ctags": [{"_type": "tag", "name": "ACCESS_TOKEN_EXPIRE_MINUTES", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^ACCESS_TOKEN_EXPIRE_MINUTES = 60 * 8   # 8 hours$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "ADMIN", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^    ADMIN = \"admin\"$/", "language": "Python", "kind": "variable", "scope": "RoleEnum", "scopeKind": "class"}, {"_type": "tag", "name": "ALGORITHM", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^ALGORITHM = \"HS256\"$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "Base", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^Base = declarative_base()$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "Config", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^    class Config:$/", "language": "Python", "kind": "class", "scope": "DigitalIDHolderOut", "scopeKind": "class"}, {"_type": "tag", "name": "Config", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^    class Config:$/", "language": "Python", "kind": "class", "scope": "InvitationOut", "scopeKind": "class"}, {"_type": "tag", "name": "Config", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^    class Config:$/", "language": "Python", "kind": "class", "scope": "LinkageHistoryOut", "scopeKind": "class"}, {"_type": "tag", "name": "Config", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^    class Config:$/", "language": "Python", "kind": "class", "scope": "UniqueNumberOut", "scopeKind": "class"}, {"_type": "tag", "name": "Config", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^    class Config:$/", "language": "Python", "kind": "class", "scope": "UserOut", "scopeKind": "class"}, {"_type": "tag", "name": "DigitalIDHolder", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^class DigitalIDHolder(Base):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "DigitalIDHolderBase", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^class DigitalIDHolderBase(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "DigitalIDHolderCreate", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^class DigitalIDHolderCreate(DigitalIDHolderBase):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "DigitalIDHolderOut", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^class DigitalIDHolderOut(DigitalIDHolderBase):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "DigitalIDHolderUpdate", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^class DigitalIDHolderUpdate(DigitalIDHolderBase):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "Invitation", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^class Invitation(Base):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "InvitationCreate", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^class InvitationCreate(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "InvitationOut", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^class InvitationOut(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "LINK", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^    LINK = \"link\"$/", "language": "Python", "kind": "variable", "scope": "LinkageAction", "scopeKind": "class"}, {"_type": "tag", "name": "LinkageAction", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^class LinkageAction(str, PyEnum):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "LinkageHistory", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^class LinkageHistory(Base):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "LinkageHistoryOut", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^class LinkageHistoryOut(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "MYSQL_DB", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^MYSQL_DB = os.getenv(\"MYSQL_DB\", \"digital_id\")$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "MYSQL_HOST", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^MYSQL_HOST = os.getenv(\"MYSQL_URL\", \"localhost\")$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "MYSQL_PASS", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^MYSQL_PASS = os.getenv(\"MYSQL_PASSWORD\", \"password\")$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "MYSQL_PORT", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^MYSQL_PORT = os.getenv(\"MYSQL_PORT\", \"3306\")$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "MYSQL_URL", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^MYSQL_URL = f\"mysql+pymysql:\\/\\/{MYSQL_USER}:{MYSQL_PASS}@{MYSQL_HOST}:{MYSQL_PORT}\\/{MYSQL_DB}\"$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "MYSQL_USER", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^MYSQL_USER = os.getenv(\"MYSQL_USER\", \"root\")$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "PyEnum", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^from enum import Enum as PyEnum$/", "language": "Python", "kind": "unknown", "nameref": "unknown:Enum"}, {"_type": "tag", "name": "RoleEnum", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^class RoleEnum(str, PyEnum):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "SAEnum", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^from sqlalchemy import (Column, Integer, String, ForeignKey, DateTime, Enum as SAEnum, Boolean,$/", "language": "Python", "kind": "unknown", "nameref": "unknown:Enum"}, {"_type": "tag", "name": "SECRET_KEY", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^SECRET_KEY = os.getenv(\"JWT_SECRET\", \"very_secret_val\")$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "SUPERADMIN", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^    SUPERADMIN = \"superadmin\"$/", "language": "Python", "kind": "variable", "scope": "RoleEnum", "scopeKind": "class"}, {"_type": "tag", "name": "SessionLocal", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^SessionLocal = scoped_session(sessionmaker(autocommit=False, autoflush=False, bind=engine))$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "Token", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^class Token(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "TokenData", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^class TokenData(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "UNLINK", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^    UNLINK = \"unlink\"$/", "language": "Python", "kind": "variable", "scope": "LinkageAction", "scopeKind": "class"}, {"_type": "tag", "name": "UniqueNumber", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^class UniqueNumber(Base):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "UniqueNumberBase", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^class UniqueNumberBase(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "UniqueNumberCreate", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^class UniqueNumberCreate(UniqueNumberBase):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "UniqueNumberOut", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^class UniqueNumberOut(UniqueNumberBase):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "User", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^class User(Base):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "UserBase", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^class UserBase(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "UserCreate", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^class UserCreate(UserBase):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "UserOut", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^class UserOut(UserBase):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "UserRegisterFromInvite", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^class UserRegisterFromInvite(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "__tablename__", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^    __tablename__ = \"digital_id_holders\"$/", "file": true, "language": "Python", "kind": "variable", "scope": "DigitalIDHolder", "scopeKind": "class"}, {"_type": "tag", "name": "__tablename__", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^    __tablename__ = \"invitations\"$/", "file": true, "language": "Python", "kind": "variable", "scope": "Invitation", "scopeKind": "class"}, {"_type": "tag", "name": "__tablename__", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^    __tablename__ = \"linkage_history\"$/", "file": true, "language": "Python", "kind": "variable", "scope": "LinkageHistory", "scopeKind": "class"}, {"_type": "tag", "name": "__tablename__", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^    __tablename__ = \"unique_numbers\"$/", "file": true, "language": "Python", "kind": "variable", "scope": "UniqueNumber", "scopeKind": "class"}, {"_type": "tag", "name": "__tablename__", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^    __tablename__ = \"users\"$/", "file": true, "language": "Python", "kind": "variable", "scope": "User", "scopeKind": "class"}, {"_type": "tag", "name": "accepted", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^    accepted = Column(Boolean, default=False)$/", "language": "Python", "kind": "variable", "scope": "Invitation", "scopeKind": "class"}, {"_type": "tag", "name": "access_token", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^    access_token: str = Field(..., description=\"JWT access token\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "Token", "scopeKind": "class"}, {"_type": "tag", "name": "action", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^    action = Column(String)  # 'link' or 'unlink'$/", "language": "Python", "kind": "variable", "scope": "LinkageHistory", "scopeKind": "class"}, {"_type": "tag", "name": "additional_info", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^    additional_info = Column(String, nullable=True)$/", "language": "Python", "kind": "variable", "scope": "DigitalIDHolder", "scopeKind": "class"}, {"_type": "tag", "name": "additional_info", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^    additional_info: Optional[str] = ''$/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "variable", "scope": "DigitalIDHolderBase", "scopeKind": "class"}, {"_type": "tag", "name": "admin", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^    admin = relationship(\"User\", back_populates=\"histories\")$/", "language": "Python", "kind": "variable", "scope": "LinkageHistory", "scopeKind": "class"}, {"_type": "tag", "name": "admin_id", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^    admin_id = Column(Integer, ForeignKey(\"users.id\"))$/", "language": "Python", "kind": "variable", "scope": "LinkageHistory", "scopeKind": "class"}, {"_type": "tag", "name": "app", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^app = FastAPI($/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "assigned_at", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^    assigned_at = Column(DateTime, nullable=True)$/", "language": "Python", "kind": "variable", "scope": "UniqueNumber", "scopeKind": "class"}, {"_type": "tag", "name": "contact_email", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^    contact_email = Column(String, nullable=True)$/", "language": "Python", "kind": "variable", "scope": "DigitalIDHolder", "scopeKind": "class"}, {"_type": "tag", "name": "create_access_token", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^def create_access_token(data: dict, expires_delta: timedelta = None):$/", "language": "Python", "kind": "function", "signature": "(data: dict, expires_delta: timedelta = None)"}, {"_type": "tag", "name": "create_holder", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^def create_holder($/", "language": "Python", "kind": "function", "signature": "( data: DigitalIDHolderCreate, db: Session = Depends(get_db), current_user: User = Depends(get_current_admin) )"}, {"_type": "tag", "name": "create_unique_number", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^def create_unique_number($/", "language": "Python", "kind": "function", "signature": "( data: UniqueNumberCreate, db: Session = Depends(get_db), current_user: User = Depends(get_current_admin) )"}, {"_type": "tag", "name": "created_at", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^    created_at = Column(DateTime, default=datetime.utcnow)$/", "language": "Python", "kind": "variable", "scope": "DigitalIDHolder", "scopeKind": "class"}, {"_type": "tag", "name": "created_at", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^    created_at = Column(DateTime, default=datetime.utcnow)$/", "language": "Python", "kind": "variable", "scope": "Invitation", "scopeKind": "class"}, {"_type": "tag", "name": "decode_access_token", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^def decode_access_token(token: str) -> dict:$/", "language": "Python", "typeref": "typename:dict", "kind": "function", "signature": "(token: str)"}, {"_type": "tag", "name": "delete_holder", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^def delete_holder(holder_id: int, db: Session = Depends(get_db), current_user: User = Depends(ge/", "language": "Python", "kind": "function", "signature": "(holder_id: int, db: Session = Depends(get_db), current_user: User = Depends(get_current_admin))"}, {"_type": "tag", "name": "dotenv_path", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^    dotenv_path = os.path.join(os.path.dirname(os.path.dirname(os.path.dirname(__file__))), '.en/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "email", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^    email = Column(String, unique=True, index=True, nullable=False)$/", "language": "Python", "kind": "variable", "scope": "User", "scopeKind": "class"}, {"_type": "tag", "name": "email", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^    email = Column(String, unique=True, nullable=False)$/", "language": "Python", "kind": "variable", "scope": "Invitation", "scopeKind": "class"}, {"_type": "tag", "name": "engine", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^engine = create_engine(MYSQL_URL, echo=False, future=True)$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "full_name", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^    full_name = Column(String, nullable=True)$/", "language": "Python", "kind": "variable", "scope": "User", "scopeKind": "class"}, {"_type": "tag", "name": "get_current_active_user", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^def get_current_active_user(current_user: User = Depends(get_current_user)):$/", "language": "Python", "kind": "function", "signature": "(current_user: User = Depends(get_current_user))"}, {"_type": "tag", "name": "get_current_admin", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^def get_current_admin(current_user: User = Depends(get_current_user)):$/", "language": "Python", "kind": "function", "signature": "(current_user: User = Depends(get_current_user))"}, {"_type": "tag", "name": "get_current_superadmin", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^def get_current_superadmin(current_user: User = Depends(get_current_user)):$/", "language": "Python", "kind": "function", "signature": "(current_user: User = Depends(get_current_user))"}, {"_type": "tag", "name": "get_current_user", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^def get_current_user(db: Session = Depends(get_db), token: str = Depends(oauth2_scheme)):$/", "language": "Python", "kind": "function", "signature": "(db: Session = Depends(get_db), token: str = Depends(oauth2_scheme))"}, {"_type": "tag", "name": "get_db", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^def get_db():$/", "language": "Python", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "get_history", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^def get_history($/", "language": "Python", "kind": "function", "signature": "( db: Session = Depends(get_db), holder_id: int = Query(None), number_id: int = Query(None), admin_id: int = Query(None), skip: int = Query(0), limit: int = Query(100), current_user: User = Depends(get_current_admin) )"}, {"_type": "tag", "name": "get_holder", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^def get_holder(holder_id: int, db: Session = Depends(get_db), current_user: User = Depends(get_c/", "language": "Python", "kind": "function", "signature": "(holder_id: int, db: Session = Depends(get_db), current_user: User = Depends(get_current_admin))"}, {"_type": "tag", "name": "get_my_profile", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^def get_my_profile(current_user: User = Depends(get_current_active_user)):$/", "language": "Python", "kind": "function", "signature": "(current_user: User = Depends(get_current_active_user))"}, {"_type": "tag", "name": "get_password_hash", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^def get_password_hash(password):$/", "language": "Python", "kind": "function", "signature": "(password)"}, {"_type": "tag", "name": "hashed_password", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^    hashed_password = Column(String)$/", "language": "Python", "kind": "variable", "scope": "User", "scopeKind": "class"}, {"_type": "tag", "name": "health_check", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^def health_check():$/", "language": "Python", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "histories", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^    histories = relationship(\"LinkageHistory\", back_populates=\"admin\")$/", "language": "Python", "kind": "variable", "scope": "User", "scopeKind": "class"}, {"_type": "tag", "name": "holder", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^    holder = relationship(\"DigitalIDHolder\", back_populates=\"link_histories\")$/", "language": "Python", "kind": "variable", "scope": "LinkageHistory", "scopeKind": "class"}, {"_type": "tag", "name": "holder", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^    holder = relationship(\"DigitalIDHolder\", back_populates=\"unique_numbers\")$/", "language": "Python", "kind": "variable", "scope": "UniqueNumber", "scopeKind": "class"}, {"_type": "tag", "name": "holder_id", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^    holder_id = Column(Integer, ForeignKey(\"digital_id_holders.id\"))$/", "language": "Python", "kind": "variable", "scope": "LinkageHistory", "scopeKind": "class"}, {"_type": "tag", "name": "holder_id", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^    holder_id = Column(Integer, ForeignKey(\"digital_id_holders.id\"), nullable=True)$/", "language": "Python", "kind": "variable", "scope": "UniqueNumber", "scopeKind": "class"}, {"_type": "tag", "name": "id", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^    id = Column(Integer, primary_key=True, index=True)$/", "language": "Python", "kind": "variable", "scope": "DigitalIDHolder", "scopeKind": "class"}, {"_type": "tag", "name": "id", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^    id = Column(Integer, primary_key=True, index=True)$/", "language": "Python", "kind": "variable", "scope": "Invitation", "scopeKind": "class"}, {"_type": "tag", "name": "id", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^    id = Column(Integer, primary_key=True, index=True)$/", "language": "Python", "kind": "variable", "scope": "LinkageHistory", "scopeKind": "class"}, {"_type": "tag", "name": "id", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^    id = Column(Integer, primary_key=True, index=True)$/", "language": "Python", "kind": "variable", "scope": "UniqueNumber", "scopeKind": "class"}, {"_type": "tag", "name": "id", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^    id = Column(Integer, primary_key=True, index=True)$/", "language": "Python", "kind": "variable", "scope": "User", "scopeKind": "class"}, {"_type": "tag", "name": "init_db", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^def init_db():$/", "language": "Python", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "invitations", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^    invitations = relationship(\"Invitation\", back_populates=\"invitee\", foreign_keys=\"Invitation./", "language": "Python", "kind": "variable", "scope": "User", "scopeKind": "class"}, {"_type": "tag", "name": "invite_admin", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^def invite_admin($/", "language": "Python", "kind": "function", "signature": "( payload: InvitationCreate, db: Session = Depends(get_db), current_user: User = Depends(get_current_superadmin), )"}, {"_type": "tag", "name": "invite_token", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^    invite_token = Column(String, nullable=False)$/", "language": "Python", "kind": "variable", "scope": "Invitation", "scopeKind": "class"}, {"_type": "tag", "name": "invited_admins", "path": "/home/kavia/workspace/code-generation/digital-id-management-dashboard-e45cba16/digital_id_backend/src/api/main.py", "pattern": "/^    invited_admins = relationship(\"User\", backref=\"inviter\", remote_side=[id])$/", "language": "Python", "kind": "variable", "scope": "User", "scopeKind": "class"}], "hash": "acbef545284ba3f8c49cb17b6ea42dd1", "format-version": 4, "code-base-name": "digital_id_backend", "filename": "digital_id_backend/src/api/main.py", "fields": [{"name": "ACCESS_TOKEN_EXPIRE_MINUTES = 60 * 8   # 8 hours", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "ADMIN = \"admin\"", "scope": "RoleEnum", "scopeKind": "class", "description": "unavailable"}, {"name": "ALGORITHM = \"HS256\"", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "Base = declarative_base()", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "LINK = \"link\"", "scope": "LinkageAction", "scopeKind": "class", "description": "unavailable"}, {"name": "MYSQL_DB = os.getenv(\"MYSQL_DB\", \"digital_id\")", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "MYSQL_HOST = os.getenv(\"MYSQL_URL\", \"localhost\")", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "MYSQL_PASS = os.getenv(\"MYSQL_PASSWORD\", \"password\")", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "MYSQL_PORT = os.getenv(\"MYSQL_PORT\", \"3306\")", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "MYSQL_URL = f\"mysql+pymysql:\\/\\/{MYSQL_USER}:{MYSQL_PASS}@{MYSQL_HOST}:{MYSQL_PORT}\\/{MYSQL_DB}\"", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "MYSQL_USER = os.getenv(\"MYSQL_USER\", \"root\")", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "SECRET_KEY = os.getenv(\"JWT_SECRET\", \"very_secret_val\")", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "SUPERADMIN = \"superadmin\"", "scope": "RoleEnum", "scopeKind": "class", "description": "unavailable"}, {"name": "SessionLocal = scoped_session(sessionmaker(autocommit=False, autoflush=False, bind=engine))", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "UNLINK = \"unlink\"", "scope": "LinkageAction", "scopeKind": "class", "description": "unavailable"}, {"name": "__tablename__ = \"digital_id_holders\"", "scope": "DigitalIDHolder", "scopeKind": "class", "description": "unavailable"}, {"name": "__tablename__ = \"invitations\"", "scope": "Invitation", "scopeKind": "class", "description": "unavailable"}, {"name": "__tablename__ = \"linkage_history\"", "scope": "LinkageHistory", "scopeKind": "class", "description": "unavailable"}, {"name": "__tablename__ = \"unique_numbers\"", "scope": "UniqueNumber", "scopeKind": "class", "description": "unavailable"}, {"name": "__tablename__ = \"users\"", "scope": "User", "scopeKind": "class", "description": "unavailable"}, {"name": "accepted = Column(Boolean, default=False)", "scope": "Invitation", "scopeKind": "class", "description": "unavailable"}, {"name": "str access_token", "scope": "Token", "scopeKind": "class", "description": "unavailable"}, {"name": "action = Column(String)  # 'link' or 'unlink'", "scope": "LinkageHistory", "scopeKind": "class", "description": "unavailable"}, {"name": "additional_info = Column(String, nullable=True)", "scope": "DigitalIDHolder", "scopeKind": "class", "description": "unavailable"}, {"name": "Optional[str] additional_info", "scope": "DigitalIDHolderBase", "scopeKind": "class", "description": "unavailable"}, {"name": "admin = relationship(\"User\", back_populates=\"histories\")", "scope": "LinkageHistory", "scopeKind": "class", "description": "unavailable"}, {"name": "admin_id = Column(Integer, ForeignKey(\"users.id\"))", "scope": "LinkageHistory", "scopeKind": "class", "description": "unavailable"}, {"name": "app = FastAPI(", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "assigned_at = Column(DateTime, nullable=True)", "scope": "UniqueNumber", "scopeKind": "class", "description": "unavailable"}, {"name": "contact_email = Column(String, nullable=True)", "scope": "DigitalIDHolder", "scopeKind": "class", "description": "unavailable"}, {"name": "created_at = Column(DateTime, default=datetime.utcnow)", "scope": "DigitalIDHolder", "scopeKind": "class", "description": "unavailable"}, {"name": "dotenv_path = os.path.join(os.path.dirname(os.path.dirname(os.path.dirname(__file__))), '.en/", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "email = Column(String, unique=True, index=True, nullable=False)", "scope": "User", "scopeKind": "class", "description": "unavailable"}, {"name": "email = Column(String, unique=True, nullable=False)", "scope": "Invitation", "scopeKind": "class", "description": "unavailable"}, {"name": "engine = create_engine(MYSQL_URL, echo=False, future=True)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "full_name = Column(String, nullable=True)", "scope": "User", "scopeKind": "class", "description": "unavailable"}, {"name": "hashed_password = Column(String)", "scope": "User", "scopeKind": "class", "description": "unavailable"}, {"name": "histories = relationship(\"LinkageHistory\", back_populates=\"admin\")", "scope": "User", "scopeKind": "class", "description": "unavailable"}, {"name": "holder = relationship(\"DigitalIDHolder\", back_populates=\"link_histories\")", "scope": "LinkageHistory", "scopeKind": "class", "description": "unavailable"}, {"name": "holder = relationship(\"DigitalIDHolder\", back_populates=\"unique_numbers\")", "scope": "UniqueNumber", "scopeKind": "class", "description": "unavailable"}, {"name": "holder_id = Column(Integer, ForeignKey(\"digital_id_holders.id\"))", "scope": "LinkageHistory", "scopeKind": "class", "description": "unavailable"}, {"name": "holder_id = Column(Integer, ForeignKey(\"digital_id_holders.id\"), nullable=True)", "scope": "UniqueNumber", "scopeKind": "class", "description": "unavailable"}, {"name": "id = Column(Integer, primary_key=True, index=True)", "scope": "DigitalIDHolder", "scopeKind": "class", "description": "unavailable"}, {"name": "invitations = relationship(\"Invitation\", back_populates=\"invitee\", foreign_keys=\"Invitation./", "scope": "User", "scopeKind": "class", "description": "unavailable"}, {"name": "invite_token = Column(String, nullable=False)", "scope": "Invitation", "scopeKind": "class", "description": "unavailable"}, {"name": "invited_admins = relationship(\"User\", backref=\"inviter\", remote_side=[id])", "scope": "User", "scopeKind": "class", "description": "unavailable"}]}